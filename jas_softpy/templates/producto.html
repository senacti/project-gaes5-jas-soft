{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/Header.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/footer.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/buttons.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/estilos-dash-admin.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/jquery.dataTables.min.css' %}">
        <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>

        <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

        <link rel="shortcut icon" href="{% static 'img/iconlogo.png' %}">
        <title>PromoPlast | Inventario</title>
    </head>

    <body onload="obtenerFechaActual()">
        <!-- The Modal -->
        <div class="modal" id="create">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">

                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title">Registrar inventario</h4>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <!-- Modal body -->
                    <form action="@{/producto/guardar}" class="was-validated" object="${producto}" method="post">
                        <div class="modal-body">
                            <div class="row">                        
                                <div class="form-floating mt-3 mb-3 col-6">
                                    <input type="text" required class="form-control" id="cantidadproducto" field="*{cantidadproducto}"
                                        placeholder="cantidadproducto"  maxlength="#"
                                        onKeypress="if (event.keyCode < 45 || event.keyCode > 57) event.returnValue = false;">
                                    <label for="cantidadproducto">Cantidad</label>
                                </div>
                                <div class="form-floating mt-3 mb-3 col-6">
                                    <select class="form-select" id="idnombreproducto" field="*{idnombreproducto}" placeholder="Estado">
                                        <option value="0">Seleccione</option>
                                        <option value="1">Botella de plástico</option>
                                        <option value="2">gancho de plástico</option>
                                    </select>
                                    <label for="idnombreproducto" class="form-label">producto</label>
                                </div>    
                                <div class="form-floating mt-3 mb-3 col-6">
                                    <select class="form-select" id="valorunidadmedidaproducto" field="*{valorunidadmedidaproducto}" name="valorunidadmedidaproducto">
                                        <option value="0">Seleccione</option>
                                        <option value="Kg">Kg</option>
                                        <option value="Gr">Gr</option>
                                        <option value="L">L</option>
                                        <option value="Ms">Ms</option>
                                        <option value="Cm">Cm</option>
                                    </select>
                                    <label for="valorunidadmedidaproducto" class="form-label">Unidad</label>
                                </div>
                                <div class="form-floating mt-3 mb-3 col-4">
                                    <select class="form-select form-control" id="idcolor" field="*{idcolor}" placeholder="idcolor"
                                        name="idcolor" required >
                                        <option value="0">Seleccione</option>
                                        <option value="Rojo">Rojo</option>
                                        <option value="Verde">Verde</option>
                                        <option value="Azul">Azul</option>
                                        <option value="Amarillo">Amarillo</option>
                                        <option value="Negro">Negro</option>
                                    </select>
                                    <label for="idcolor">Color</label>
                                </div> 
                                <div class="form-floating mt-3 mb-3 col-6">
                                    <select class="form-select" id="idempleado" field="*{idempleado}" name="idempleado">
                                        <option value="0">Seleccione</option>
                                        <option value="Juan">juan</option>
                                        <option value="Pedro">Pedro</option>
                                        <option value="Maria">Maria</option>
                                        <option value="Cristian">Cristian</option>
                                        <option value="Samuel">Samuel</option>
                                    </select>
                                    <label for="idempleado" class="form-label">Empleado</label>
                                </div>
                                <div class="form-floating mt-3 mb-3 col-6">
                                    <select class="form-select" id="idestadoproducto" field="*{idestadoproducto}" placeholder="Estado" name="idestadoproducto">
                                        <option value="0">Seleccione</option>
                                        <option value="Stock">Stock</option>
                                        <option value="Transito">Transito</option>
                                        <option value="Vendido">Vendido</option>
                                        <option value="Devuelto">Devuelto</option>
                                        <option value="Defectuoso">Defectuoso</option>
                                    </select>
                                    <label for="idestadoproducto" class="form-label">Estado</label>
                                </div>
                                <div class="form-floating mt-3 mb-3 col-6">
                                    <input type="text" class="form-control" id="tamaño" placeholder="tamaño"
                                        name="tamaño">
                                    <label for="tamaño">Tamaño</label>
                                </div>
                                <div class="form-floating mt-3 mb-9">
                                    <input type="datetime-local" required class="form-control" id="fechafabricacion" placeholder="fecha Venta"  field="*{fechafabricacion}" maxlength="20">
                                    <label for="fechafabricacion">Fecha de fabricacion</label>
                                </div>
                                <!--<div class="form-floating mt-3 mb-3 col-9">
                                    <input type="datetime-local" id="fechafabricacion" name="fechafabricacion">Fecha de fabricacion
                                </div>-->
                                <button type="submit" id="submitproducto" class="hidden"></button>
                            </div>
                        </div>
                    </form>
                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                        <button type="button" onclick="document.getElementById('submitproducto').click();return false;"
                            class="btn btn-primary">Guardar</button>
                    </div>
                </div>
            </div>
        </div>


        <header class="dash-menu">
            <img class="logo-dash-admin" src="{% static 'img/logo.png' %}" alt="logo">
            <a class="nav-link" href="@{/}">INICIO</a>
            <ul class="list-menu-ul">
                <li class="list-menu-dash" style="margin-right: -10px"> <img class="img-menu-dash" src="{% static 'img/campana.png' %}" alt="Campana"> </li>
                <li class="nav-item dropdown" style="margin-right: -200px;">
                    <a id="navbarDropdown" class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false" v-pre>
                        <span sec:authentication="principal.username"></span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown" id="cerrar">
                        <a class="dropdown-item" href="@{/logout}" onclick="event.preventDefault();
                                document.getElementById('logout-form').submit();">
                            Cerrar sesión
                        </a>

                        <form id="logout-form" action="@{/logout}" method="POST" class="d-none">
                        </form>
                    </div>
                </li>
            </ul>
            <li class="list-menu-dash"> <img class="img-menu-dash-users" src="{% static 'img/usuario.png' %}" alt="">
            </li>
        </header>
        
        <div class="container-fluid">
            <div class="row">
                <div class="col-2 barmenu">
                    <h3 class="mt-4">PROMOPLAST</h3>
                    <p></p>
                    <ul class="nav nav-pills flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'home' %}">MENU</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'ordenpedido' %}">PRODUCCION</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'producto' %}">INVENTARIO</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'ventas' %}">VENTAS</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'rrhh' %}">GESTION P.</a>
                        </li>
                    </ul>
                </div>

                <div class="col-10" id="contentd">
                    <div class="card" id="cardash">
                        <div class="container mt-3">
                            <h2>{{ message }}</h2>
                            <!--
                            <div if=${param.exito}>
                                <div class="alert alert-info" style="color: forestgreen;">Proceso Exitoso
                                </div>
                            </div>
                            <div if=${param.error}>
                                <div class="alert alert-danger" style="color: red;">Hubo un problema en el proceso </div>
                            </div>
                            <div if=${param.exitoeliminar}>
                                <div class="alert alert-info" style="color: forestgreen;">eliminado Correctamente</div>
                            </div>
                            <div if=${param.erroreliminar}>
                                <div class="alert alert-danger" style="color: red;">Hubo un problema al eliminar </div>
                            </div>
                            -->
                            <p></p>
                            <table class="table table-striped" id="tablas">
                                <thead class="thead">
                                    <tr>                                        
                                        <th>Nombre</th>
                                        <th>Cantidad</th>
                                        <th>Fecha Fabricación</th>
                                        <th>Tamaño</th>
                                        <th>Color</th>
                                        <th>Estado</th>                                        
                                        <td >Acciones</td>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for Product in object_list %}
                                    <tr>                                        
                                        <td>{{Product.name}}</td>
                                        <td>{{Product.stock}}</td>
                                        <td>{{Product.fabricationDate}}</td>
                                        <td>{{Product.size}}</td>
                                        <td>{{Product.color}}</td>
                                        <td>{{Product.state}}</td>                                        
                                        <td>
                                            <a href="@{/producto/editar/} + ${in.idproducto}" >
                                                <button type="button" class="btn btn-success" >
                                                    Editar
                                                </button>
                                            </a>
                                            <a href="@{/producto/eliminar/} + ${in.idproducto}">
                                                <button type="button" class="btn btn-danger" >
                                                    Eliminar
                                                </button>
                                            </a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            <div class="button-new">
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#create">
                                    Agregar Productos
                                </button>
                                <a class="button-excel" href="@{/producto/exportar/excel}">
                                    Exportar a Excel
                                </a>
                            </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script type="text/javascript" src="{% static 'js/jquery.dataTables.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/dataTables.bootstrap.min.js' %}"></script>

        <script>
            $(document).ready(function () {
                var oTable = $("#tablas").dataTable({
                    dom: 'Bfrtip',

                    language: {
                        sProcessing: "Procesando...",
                        sLengthMenu: "Mostrar MENU",
                        sZeroRecords: "No se encontraron resultados",
                        sEmptyTable: "Ningún dato disponible en esta tabla",
                        sInfo: "Mostrando del inicio al fin de un total de registros",
                        sInfoEmpty: "Mostrando del 0 al 0 de un total de 0 registros",
                        sInfoFiltered: "(filtrado de un total de MAX registros)",
                        sInfoPostFix: "",
                        sSearch: "Buscar:",
                        sUrl: "",
                        sInfoThousands: ",",
                        sLoadingRecords: "Cargando...",
                        oPaginate: {
                            sFirst: "Primero",
                            sLast: "Último",
                            sNext: "Siguiente",
                            sPrevious: "Anterior"
                        },
                        oAria: {
                            sSortAscending: ": Activar para ordenar la columna de manera ascendente",
                            sSortDescending: ": Activar para ordenar la columna de manera descendente"
                        },
                    },
                });

            });

            function mostrarid() {
                id = document.getElementById('idproducto').value;
                alert(id);
            }

            function abrirmodal() {
                $('#editar').show();
            }

            function obtenerFechaActual() {
                const fechaActual = new Date().toISOString().split('T')[0];
                document.getElementById('fechafabricacion').min = fechaActual;
            }
        </script>
    </body>

</html>
